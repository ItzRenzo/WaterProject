<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clients - RJane Water Refilling Station</title>
    <link rel="stylesheet" href="../../Css/customers.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="NavBar.html">
</head>

<body>
    <div id="navbar"></div>

    <script>
        fetch('navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
    </script>
    <div class="main-content">


        <!-- Client Management Header -->
        <div class="dashboard-header">
            <h2>Client Management</h2>
            <button class="primary-btn" id="newClientBtn">
                <i class="fas fa-plus"></i> New Client
            </button>
        </div>

        <!-- Filter Options -->
        <div class="filters-container">
            <div class="filter-options">
                <select class="filter-select">
                    <option>All Clients</option>
                    <option>Active</option>
                    <option>Inactive</option>
                </select>
                <select class="filter-select">
                    <option>All Locations</option>
                    <option>City Center</option>
                    <option>North Area</option>
                    <option>South Area</option>
                </select>
            </div>
            <div class="view-options">
                <button class="view-btn active" data-view="grid"><i class="fas fa-th"></i></button>
                <button class="view-btn" data-view="list"><i class="fas fa-list"></i></button>
            </div>
        </div>

        <!-- Client Grid View -->
        <div class="client-grid" id="gridView">
            <!-- Client Cards will be generated by JavaScript -->
        </div>

        <!-- Client List View (Hidden by Default) -->
        <div class="client-list" id="listView" style="display: none;">
            <table class="clients-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Contact</th>
                        <th>Address</th>
                        <th>Status</th>
                        <th>Orders</th>
                        <th>Last Order</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="clientTableBody">
                    <!-- Table rows will be generated by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="pagination">
            <button class="pagination-btn"><i class="fas fa-chevron-left"></i></button>
            <button class="pagination-btn active">1</button>
            <button class="pagination-btn">2</button>
            <button class="pagination-btn">3</button>
            <button class="pagination-btn"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

    <!-- Add Client Modal -->
    <div class="modal" id="addClientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Client</h3>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="newClientForm">
                    <div class="form-group">
                        <label for="CustomerName">Customer Name</label>
                        <input type="text" id="CustomerName" name="CustomerName" required>
                    </div>
                    <div class="form-group">
                        <label for="CustomerNumber">Contact Number</label>
                        <input type="tel" id="CustomerNumber" name="CustomerNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="CustomerAddress">Address</label>
                        <input type="text" id="CustomerAddress" name="CustomerAddress" required>
                    </div>
                    <!-- Add form actions -->
                    <div class="form-actions">
                        <button type="button" class="secondary-btn" id="cancelBtn">Cancel</button>
                        <button type="submit" class="primary-btn">Save Customer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Sample client data
        const clients = [
            {
                id: 1,
                name: "John Doe",
                phone: "+63 912 345 6789",
                address: "123 Main St, City",
                status: "active",
                orders: 15,
                lastOrder: "2d ago"
            },
            {
                id: 2,
                name: "Jane Smith",
                phone: "+63 923 456 7890",
                address: "456 Oak Ave, City",
                status: "active",
                orders: 8,
                lastOrder: "5d ago"
            },
            {
                id: 3,
                name: "Michael Johnson",
                phone: "+63 934 567 8901",
                address: "789 Pine Blvd, City",
                status: "inactive",
                orders: 3,
                lastOrder: "2w ago"
            },
            {
                id: 4,
                name: "Sarah Williams",
                phone: "+63 945 678 9012",
                address: "321 Cedar St, City",
                status: "active",
                orders: 12,
                lastOrder: "1d ago"
            }
        ];

        // DOM Elements
        const gridView = document.getElementById('gridView');
        const listView = document.getElementById('listView');
        const clientTableBody = document.getElementById('clientTableBody');
        const viewButtons = document.querySelectorAll('.view-btn');
        const addClientModal = document.getElementById('addClientModal');
        const newClientBtn = document.getElementById('newClientBtn');
        const closeModalBtn = document.getElementById('closeModal');
        const cancelBtn = document.getElementById('cancelBtn');
        const newClientForm = document.getElementById('newClientForm');

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function () {
            renderGridView();
            renderListView();
            setupEventListeners();
        });

        // Render client cards in grid view
        function renderGridView() {
            gridView.innerHTML = '';

            clients.forEach(client => {
                const card = document.createElement('div');
                card.className = 'client-card';

                const statusClass = client.status === 'active' ? 'status-active' : 'status-inactive';
                const firstLetter = client.name.charAt(0);

                card.innerHTML = `
            <div class="client-card-header">
                <div class="client-avatar"><span>${firstLetter}</span></div>
                <div class="client-status ${statusClass}">${client.status.charAt(0).toUpperCase() + client.status.slice(1)}</div>
            </div>
            <div class="client-card-body">
                <h3>${client.name}</h3>
                <p><i class="fas fa-phone"></i> ${client.phone}</p>
                <p><i class="fas fa-location-dot"></i> ${client.address}</p>
            </div>
            <div class="client-card-footer">
                <div class="client-stats">
                    <div>
                        <span>Orders</span>
                        <h4>${client.orders}</h4>
                    </div>
                    <div>
                        <span>Last Order</span>
                        <h4>${client.lastOrder}</h4>
                    </div>
                </div>
                <div class="client-actions">
                    <button title="View Details"><i class="fas fa-eye"></i></button>
                    <button title="Edit"><i class="fas fa-edit"></i></button>
                    <button title="Delete"><i class="fas fa-trash"></i></button>
                </div>
            </div>
        `;

                gridView.appendChild(card);
            });
        }

        // Render client data in table view
        function renderListView() {
            clientTableBody.innerHTML = '';

            clients.forEach(client => {
                const row = document.createElement('tr');
                const statusClass = client.status === 'active' ? 'status-active' : 'status-inactive';

                row.innerHTML = `
            <td>${client.name}</td>
            <td>${client.phone}</td>
            <td>${client.address}</td>
            <td><span class="client-status ${statusClass}">${client.status.charAt(0).toUpperCase() + client.status.slice(1)}</span></td>
            <td>${client.orders}</td>
            <td>${client.lastOrder}</td>
            <td>
                <div class="action-buttons">
                    <button title="View Details"><i class="fas fa-eye"></i></button>
                    <button title="Edit"><i class="fas fa-edit"></i></button>
                    <button title="Delete"><i class="fas fa-trash"></i></button>
                </div>
            </td>
        `;

                clientTableBody.appendChild(row);
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // View toggle buttons
            viewButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const viewType = this.getAttribute('data-view');

                    // Update active button
                    viewButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');

                    // Show the selected view
                    if (viewType === 'grid') {
                        gridView.style.display = 'grid';
                        listView.style.display = 'none';
                    } else {
                        gridView.style.display = 'none';
                        listView.style.display = 'block';
                    }
                });
            });

            // Modal functionality
            newClientBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            cancelBtn.addEventListener('click', closeModal);

            // Close modal when clicking outside
            window.addEventListener('click', function (event) {
                if (event.target === addClientModal) {
                    closeModal();
                }
            });

            // Form submission
            newClientForm.addEventListener('submit', function (event) {
                event.preventDefault();

                const formData = {
                    name: document.getElementById('CustomerName').value,
                    phone: document.getElementById('CustomerNumber').value,
                    address: document.getElementById('CustomerAddress').value
                };

                try {
                    if (validateClientData(formData)) {
                        // Add new client
                        clients.push({
                            id: clients.length + 1,
                            ...formData,
                            status: 'active',
                            orders: 0,
                            lastOrder: 'New'
                        });

                        // Update views
                        renderGridView();
                        renderListView();

                        // Show success message
                        showNotification('Customer added successfully!');

                        // Close modal
                        closeModal();

                        // Reset form
                        newClientForm.reset();
                    }
                } catch (error) {
                    showNotification(error.message, 'error');
                }
            });
        }

        // Add this function before the form submission handler
        function validateClientData(data) {
            const phoneRegex = /^\+?63\s?[0-9]{3}\s?[0-9]{3}\s?[0-9]{4}$/;

            if (data.name.length < 2) {
                throw new Error('Name must be at least 2 characters long');
            }

            if (!phoneRegex.test(data.phone)) {
                throw new Error('Phone number must be in +63 format');
            }

            if (data.address.length < 5) {
                throw new Error('Please enter a valid address');
            }

            return true;
        }

        // Open modal function
        function openModal() {
            addClientModal.classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent scrolling
        }

        // Close modal function
        function closeModal() {
            addClientModal.classList.remove('show');
            document.body.style.overflow = ''; // Re-enable scrolling
        }

        // Show notification function
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
        <div class="notification-content">
            <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
            <span>${message}</span>
        </div>
    `;

            // Add styles
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.backgroundColor = type === 'success' ? 'var(--success)' : 'var(--error)';
            notification.style.color = 'white';
            notification.style.padding = '12px 20px';
            notification.style.borderRadius = 'var(--border-radius)';
            notification.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.1)';
            notification.style.display = 'flex';
            notification.style.alignItems = 'center';
            notification.style.zIndex = '2000';
            notification.style.transform = 'translateY(-20px)';
            notification.style.opacity = '0';
            notification.style.transition = 'all 0.3s ease';

            // Add to document
            document.body.appendChild(notification);

            // Show notification
            setTimeout(() => {
                notification.style.transform = 'translateY(0)';
                notification.style.opacity = '1';
            }, 100);

            // Remove after delay
            setTimeout(() => {
                notification.style.transform = 'translateY(-20px)';
                notification.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }


    </script>


</body>

</html>